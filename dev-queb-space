#!/bin/bash

set -e

cd "$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# clean stale processes/ports
./cleanup >/dev/null 2>&1 || true

# start lightweight dev server on port 3000 only
PORT=3000 NODE_ENV=development nohup npx nodemon --quiet backend/api/server.js >/tmp/mol_dev.out 2>&1 &

# quick health check
sleep 2
curl -sS http://localhost:3000/health | cat || true

echo "http://localhost:3000"
