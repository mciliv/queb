#!/bin/bash

# Debug Pipeline Procedure
# Maximum visibility, comprehensive logging, debug mode

echo "ðŸ” Debug Pipeline Starting..."
echo "=============================="

# Check dependencies
echo "ðŸ“¦ Checking dependencies..."
npm list --depth=0 | grep -E "(openai|express|cors|livereload)" || {
    echo "âŒ Missing dependencies. Run: npm install"
    exit 1
}

# Clean processes and ports
pkill -f "node.*server.js" 2>/dev/null || true
pkill -f "nodemon" 2>/dev/null || true
lsof -ti:35730 | xargs kill -9 2>/dev/null || true
lsof -ti:35729 | xargs kill -9 2>/dev/null || true

echo ""
echo "ðŸ”§ Starting debug mode with:"
echo "   â€¢ Maximum error visibility"
echo "   â€¢ VS Code debugger attached"  
echo "   â€¢ Live reload active"
echo "   â€¢ All logs visible"
echo ""

exec ./dev-debug 