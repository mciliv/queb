#!/bin/bash

# Simple script runner that finds scripts in their appropriate directories
# Usage: scripts/run <script-name> [args...]

SCRIPT_NAME="$1"
shift  # Remove script name from args

if [ -z "$SCRIPT_NAME" ] || [ "$SCRIPT_NAME" = "--help" ] || [ "$SCRIPT_NAME" = "-h" ]; then
    echo "Usage: scripts/run <script-name> [args...]"
    echo ""
    echo "Available scripts:"
    find . -name "*.js" -path "./frontend/*" -o -path "./backend/*" -o -path "./test/*" | grep -E "(build|dev|test|run)" | sort
    exit 1
fi

# Look for the script in appropriate directories
SCRIPT_PATH=""

# Check frontend directory
if [ -f "frontend/${SCRIPT_NAME}.js" ]; then
    SCRIPT_PATH="frontend/${SCRIPT_NAME}.js"
# Check backend directory  
elif [ -f "backend/${SCRIPT_NAME}.js" ]; then
    SCRIPT_PATH="backend/${SCRIPT_NAME}.js"
# Check test directory
elif [ -f "test/${SCRIPT_NAME}.js" ]; then
    SCRIPT_PATH="test/${SCRIPT_NAME}.js"
# Check test scripts subdirectory
elif [ -f "test/scripts/${SCRIPT_NAME}.js" ]; then
    SCRIPT_PATH="test/scripts/${SCRIPT_NAME}.js"
# Check root for project-wide scripts
elif [ -f "${SCRIPT_NAME}.js" ]; then
    SCRIPT_PATH="${SCRIPT_NAME}.js"
else
    echo "‚ùå Script '${SCRIPT_NAME}' not found"
    echo "Looked in: frontend/, backend/, test/, test/scripts/, ./"
    exit 1
fi

echo "üöÄ Running: ${SCRIPT_PATH}"
node "${SCRIPT_PATH}" "$@"
