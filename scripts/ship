#!/usr/bin/env node

import { fileURLToPath } from 'url';
import { dirname, join } from 'path';
import { access, constants } from 'fs/promises';
import { spawn } from 'child_process';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);
const repoRoot = join(__dirname, '..');
const deployScript = join(repoRoot, 'infrastructure/deployment/deploy.sh');

try {
  await access(deployScript, constants.F_OK | constants.X_OK);
  
  const child = spawn(deployScript, process.argv.slice(2), {
    stdio: 'inherit',
    cwd: repoRoot
  });
  
  process.exit(await new Promise(resolve => child.on('exit', resolve)));
  
} catch {
  console.error('No deployment script found (infrastructure/deployment/deploy.sh).');
  process.exit(1);
}


